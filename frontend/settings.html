{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MAHIKA - Privacy Settings</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <style>
        .settings-container { max-width: 700px; margin: 40px auto; color: white; padding: 20px; }
        .card { background: #1e293b; padding: 25px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #334155; }
        h2 { color: #38bdf8; margin-bottom: 15px; border-bottom: 1px solid #334155; padding-bottom: 10px; }
        p { color: #cbd5e1; line-height: 1.6; }
        
        .badge { background: #10b981; color: #064e3b; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
        
        .btn-danger { background: linear-gradient(45deg, #ef4444, #b91c1c); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; transition: transform 0.2s; }
        .btn-danger:hover { transform: scale(1.02); }
        
        .btn-warning { background: #f59e0b; color: #451a03; }
    </style>
</head>
<body>
    <header class="top-nav">
        <div class="logo">MAHIKA</div>
        <nav>
            <a href="{% url 'dashboard' %}">Dashboard</a>
            <a href="#">Settings</a>
        </nav>
    </header>

    <main class="settings-container">
        <h1>Privacy & Security Center</h1>
        <p>Manage your data sovereignty. <span class="badge">SECURE MODE ON</span></p>

        <div class="card">
            <h2>üîê Encryption Standards</h2>
            <p>MAHIKA uses <strong>HTTPS/TLS</strong> for data transmission. All passwords are salted and hashed using <strong>PBKDF2/SHA256</strong>. Your location data is only stored when necessary for SOS operations.</p>
        </div>

        <div class="card">
            <h2>üí¨ Conversation Data</h2>
            <p>We analyze text <strong>locally within the app logic</strong> to detect distress. We do not sell your chat logs.</p>
            <p>You can wipe your chat history from our servers instantly.</p>
            <button class="btn-danger btn-warning" onclick="wipeChatHistory()">üî• Delete All Chat History</button>
        </div>

        <div class="card" style="border: 1px solid #ef4444;">
            <h2 style="color: #ef4444;">‚ö†Ô∏è Danger Zone</h2>
            <p>This will permanently delete your account, trusted contacts, and location history. This action cannot be undone.</p>
            <button class="btn-danger" onclick="deleteAccount()">üíÄ Delete My Account Permanently</button>
        </div>
    </main>

    <script>
        async function wipeChatHistory() {
            if(!confirm("Are you sure? This will erase all memories of your AI companion.")) return;
            
            try {
                const response = await fetch('/api/privacy/delete-chats/', { method: 'POST' });
                const data = await response.json();
                if(response.ok) alert("‚úÖ " + data.message);
                else alert("Error: " + data.error);
            } catch(e) { console.error(e); }
        }

        async function deleteAccount() {
            const confirmation = prompt("Type 'DELETE' to confirm account destruction:");
            if(confirmation !== 'DELETE') return;

            try {
                const response = await fetch('/api/privacy/delete-account/', { method: 'POST' });
                if(response.ok) {
                    alert("Account Deleted. Goodbye.");
                    window.location.href = '/';
                }
            } catch(e) { console.error(e); }
        }
    </script>
</body>
</html>